version: '3'

networks:
  joomla:

services:
  proxy:
    image: 'jwilder/nginx-proxy:alpine'
    ports:
      - '8080:80'
    volumes:
      - '/var/run/docker.sock:/tmp/docker.sock:ro'
    networks:
      - joomla
  apachev5p4:
    build: docker/apache-5.4
    volumes:
      - '/Users/isac/Documents/Work/GSOC/joomla/virtualisation/dockyard_testing/docker/apache-5.4/conf:/etc/apache2/sites-enabled'
      - '/Users/isac/Documents/Work/GSOC/joomla/virtualisation/dockyard_testing/docker/apache-5.4/html:/var/www/html'
      - '/Users/isac/Documents/Work/GSOC/joomla/virtualisation/vendor:/usr/local/lib/php/vendor'
    links:
      - mysqlvlatest
    environment:
      VIRTUAL_HOST: 'j37-54.dev,j38dev-54.dev,jstaging-54.dev'
    networks:
      - joomla
  mysqlvlatest:
    image: 'mysql:latest'
    volumes:
      - '/Users/isac/Documents/Work/GSOC/joomla/virtualisation/dockyard_testing/mysql-latest:/docker-entrypoint-initdb.d'
    environment:
      MYSQL_DATABASE: joomla_test
      MYSQL_ROOT_PASSWORD: root
      MYSQL_USER: sqladmin
      MYSQL_PASSWORD: sqladmin
    networks:
      - joomla
  client:
    image: 'joomlaprojects/joomla-testing-client-firefox:2.53.1'
    volumes:
      - '/Users/isac/Documents/Work/GSOC/joomla/weblinks:/usr/src/tests'
    networks:
      - joomla
    ports:
      - '5901:5900'